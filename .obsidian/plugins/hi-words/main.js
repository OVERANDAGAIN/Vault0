/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var R=Object.defineProperty;var ie=Object.getOwnPropertyDescriptor;var re=Object.getOwnPropertyNames;var ae=Object.prototype.hasOwnProperty;var se=(d,e)=>{for(var t in e)R(d,t,{get:e[t],enumerable:!0})},ne=(d,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of re(e))!ae.call(d,i)&&i!==t&&R(d,i,{get:()=>e[i],enumerable:!(o=ie(e,i))||o.enumerable});return d};var le=d=>ne(R({},"__esModule",{value:!0}),d);var ue={};se(ue,{default:()=>O});module.exports=le(ue);var E=require("obsidian");var Y=require("obsidian");var _=class{constructor(e){this.app=e}removeMarkdownFormatting(e){return e&&(e=e.replace(/\*\*(.*?)\*\*/g,"$1").replace(/__(.*?)__/g,"$1"),e=e.replace(/\*(.*?)\*/g,"$1").replace(/_(.*?)_/g,"$1"),e=e.replace(/`(.*?)`/g,"$1"),e=e.replace(/~~(.*?)~~/g,"$1"),e=e.replace(/==(.*?)==/g,"$1"),e=e.replace(/\[(.*?)\]\(.*?\)/g,"$1"),e.trim())}async parseCanvasFile(e){try{let t=await this.app.vault.read(e),o=JSON.parse(t),i=[];for(let r of o.nodes)if(r.type==="text"&&r.text){let a=this.parseTextNode(r,e.path);a&&i.push(a)}return i}catch(t){return console.error(`Failed to parse canvas file ${e.path}:`,t),[]}}parseTextNode(e,t){if(!e.text)return null;let o=e.text.trim(),i="",r=[],a="";try{let n=o.split(`
`);if(n.length===0||(i=n[0].replace(/^#+\s*/,"").trim(),i=this.removeMarkdownFormatting(i),!i))return null;if(n.length>1){let p=-1,l=-1;for(let c=1;c<n.length;c++){let h=n[c].trim();if(h==="")continue;let u=h.match(/^\*(.*?)\*$/);if(u){p=c,l=c+1,r=u[1].split(",").map(v=>this.removeMarkdownFormatting(v.trim()).toLowerCase()).filter(v=>v.length>0).slice(0,10);break}else{l=c;break}}if(l>0&&l<n.length){for(;l<n.length&&n[l].trim()==="";)l++;l<n.length&&(a=n.slice(l).join(`
`).trim())}else p===-1&&(a=n.slice(1).join(`
`).trim())}return i?{word:i.toLowerCase(),aliases:r.length>0?r:void 0,definition:a,source:t,nodeId:e.id,color:e.color}:null}catch(n){return console.error(`\u89E3\u6790\u8282\u70B9\u6587\u672C\u65F6\u51FA\u9519: ${n}`),null}}static isCanvasFile(e){return e.extension==="canvas"}async validateCanvasFile(e){try{let t=await this.app.vault.read(e),o=JSON.parse(t);return Array.isArray(o.nodes)&&Array.isArray(o.edges)}catch(t){return!1}}};var z=require("obsidian");var D=class{constructor(e){this.app=e}async addWordToCanvas(e,t,o,i,r){try{let a=this.app.vault.getAbstractFileByPath(e);if(!a||!(a instanceof z.TFile)||!_.isCanvasFile(a))return console.error(`\u65E0\u6548\u7684 Canvas \u6587\u4EF6: ${e}`),!1;let n=10;r&&r.length>n&&(console.warn(`\u522B\u540D\u6570\u91CF\u8D85\u8FC7\u9650\u5236\uFF0C\u5C06\u53EA\u4F7F\u7528\u524D ${n} \u4E2A\u522B\u540D`),r=r.slice(0,n)),r&&(r=r.filter(k=>k&&k.trim().length>0),r.length===0&&(r=void 0));let p=await this.app.vault.read(a),l=JSON.parse(p);if(!Array.isArray(l.nodes))return console.error(`\u65E0\u6548\u7684 Canvas \u6570\u636E: ${e}`),!1;let c=`node-${Date.now()}-${Math.floor(Math.random()*1e3)}`,h=0,u=0;if(l.nodes.length>0){let k=l.nodes[l.nodes.length-1];h=k.x,u=k.y+k.height+50}let g=t;r&&r.length>0&&(g=`${t}
*${r.join(", ")}*`),o&&(g=`${g}

${o}`);let v={id:c,type:"text",x:h,y:u,width:250,height:150,text:g,color:i!==void 0?i.toString():void 0};return l.nodes.push(v),await this.app.vault.modify(a,JSON.stringify(l,null,2)),!0}catch(a){return console.error(`\u6DFB\u52A0\u8BCD\u6C47\u5230 Canvas \u5931\u8D25: ${a}`),!1}}async updateWordInCanvas(e,t,o,i,r,a){try{let n=this.app.vault.getAbstractFileByPath(e);if(!n||!(n instanceof z.TFile)||!_.isCanvasFile(n))return console.error(`\u65E0\u6548\u7684 Canvas \u6587\u4EF6: ${e}`),!1;let p=10;a&&a.length>p&&(console.warn(`\u522B\u540D\u6570\u91CF\u8D85\u8FC7\u9650\u5236\uFF0C\u5C06\u53EA\u4F7F\u7528\u524D ${p} \u4E2A\u522B\u540D`),a=a.slice(0,p)),a&&(a=a.filter(g=>g&&g.trim().length>0),a.length===0&&(a=void 0));let l=await this.app.vault.read(n),c=JSON.parse(l);if(!Array.isArray(c.nodes))return console.error(`\u65E0\u6548\u7684 Canvas \u6570\u636E: ${e}`),!1;let h=c.nodes.findIndex(g=>g.id===t);if(h===-1)return console.error(`\u672A\u627E\u5230\u8282\u70B9: ${t}`),!1;let u=o;return a&&a.length>0&&(u=`${o}
*${a.join(", ")}*`),i&&(u=`${u}

${i}`),c.nodes[h].text=u,r!==void 0&&(c.nodes[h].color=r.toString()),await this.app.vault.modify(n,JSON.stringify(c,null,2)),!0}catch(n){return console.error(`\u66F4\u65B0 Canvas \u4E2D\u7684\u8BCD\u6C47\u5931\u8D25: ${n}`),!1}}};var $=class{constructor(e,t){this.definitions=new Map;this.wordDefinitionCache=new Map;this.allWordsCache=[];this.bookWordsCache=new Map;this.cacheValid=!1;this.app=e,this.canvasParser=new _(e),this.canvasEditor=new D(e),this.settings=t}async loadAllVocabularyBooks(){let e=performance.now();this.definitions.clear(),this.invalidateCache();let t=this.settings.vocabularyBooks.filter(i=>i.enabled).map(i=>this.loadVocabularyBook(i));await Promise.all(t),this.rebuildCache();let o=performance.now()}async loadVocabularyBook(e){let t=performance.now(),o=this.app.vault.getAbstractFileByPath(e.path);if(!o||!(o instanceof Y.TFile)){console.warn(`Canvas file not found: ${e.path}`);return}if(!_.isCanvasFile(o)){console.warn(`File is not a canvas: ${e.path}`);return}try{let i=await this.canvasParser.parseCanvasFile(o);this.definitions.set(e.path,i),this.invalidateCache();let r=performance.now()}catch(i){console.error(`Failed to load vocabulary book ${e.name}:`,i)}}getDefinition(e,t=new Set){let o=e.toLowerCase().trim();if(t.has(o))return null;if(t.add(o),this.cacheValid&&this.wordDefinitionCache.has(o))return this.wordDefinitionCache.get(o)||null;if(!this.cacheValid&&(this.rebuildCache(),this.wordDefinitionCache.has(o)))return this.wordDefinitionCache.get(o)||null;for(let i of this.definitions.values()){let r=i.find(n=>n.word===o);if(r)return this.wordDefinitionCache.set(o,r),r;let a=i.find(n=>n.aliases&&n.aliases.includes(o));if(a)return this.wordDefinitionCache.set(o,a),a}return null}getAllWords(){return this.cacheValid?[...this.allWordsCache]:(this.rebuildCache(),[...this.allWordsCache])}getWordsFromBook(e){if(this.cacheValid&&this.bookWordsCache.has(e))return[...this.bookWordsCache.get(e)];let t=this.definitions.get(e);if(!t)return[];let o=[];o.push(...t.map(r=>r.word)),t.forEach(r=>{r.aliases&&r.aliases.length>0&&o.push(...r.aliases)});let i=[...new Set(o)];return this.bookWordsCache.set(e,i),i}async reloadVocabularyBook(e){let t=this.settings.vocabularyBooks.find(o=>o.path===e);t&&t.enabled&&(await this.loadVocabularyBook(t),this.invalidateCache())}updateSettings(e){this.settings=e,this.invalidateCache()}getSettings(){return this.settings}getStats(){let e=this.settings.vocabularyBooks.length,t=this.settings.vocabularyBooks.filter(i=>i.enabled).length,o=this.getAllWords().length;return{totalBooks:e,enabledBooks:t,totalWords:o}}hasWord(e){let t=e.toLowerCase().trim();return this.cacheValid?this.wordDefinitionCache.has(t):this.getDefinition(e)!==null}clear(){this.definitions.clear(),this.invalidateCache()}async addWordToCanvas(e,t,o,i,r){let a=await this.canvasEditor.addWordToCanvas(e,t,o,i,r);return a&&(await this.reloadVocabularyBook(e),this.invalidateCache()),a}invalidateCache(){this.cacheValid=!1,this.wordDefinitionCache.clear(),this.allWordsCache=[],this.bookWordsCache.clear()}rebuildCache(){let e=performance.now();this.wordDefinitionCache.clear(),this.allWordsCache=[],this.bookWordsCache.clear();let t=new Set;for(let[o,i]of this.definitions.entries()){let r=new Set;for(let a of i){let n=a.word.toLowerCase().trim();if(this.wordDefinitionCache.set(n,a),t.add(n),r.add(n),a.aliases&&a.aliases.length>0)for(let p of a.aliases){let l=p.toLowerCase().trim();this.wordDefinitionCache.set(l,a),t.add(l),r.add(l)}}this.bookWordsCache.set(o,[...r])}this.allWordsCache=[...t],this.cacheValid=!0}async updateWordInCanvas(e,t,o,i,r,a){let n=await this.canvasEditor.updateWordInCanvas(e,t,o,i,r,a);return n&&await this.reloadVocabularyBook(e),n}};var x=require("@codemirror/state"),C=require("@codemirror/view");function T(d,e="var(--color-accent)"){return d?{1:"var(--color-red)",2:"var(--color-orange)",3:"var(--color-yellow)",4:"var(--color-green)",5:"var(--color-cyan)",6:"var(--color-purple)",red:"var(--color-red)",orange:"var(--color-orange)",yellow:"var(--color-yellow)",green:"var(--color-green)",cyan:"var(--color-cyan)",blue:"var(--color-blue)",purple:"var(--color-purple)",pink:"var(--color-pink)",gray:"var(--color-base-60)",grey:"var(--color-base-60)",white:"var(--color-base-00)",black:"var(--color-base-100)"}[d.toLowerCase()]||d:e}function X(d,e=.1){return d.startsWith("var(--color-")?`color-mix(in srgb, ${d} ${e*100}%, transparent)`:d.startsWith("#")||d.startsWith("rgb")||d.startsWith("hsl")?`color-mix(in srgb, ${d} ${e*100}%, transparent)`:d}var B=class{constructor(){this.root=new S}addWord(e,t){let o=this.root,i=e.toLowerCase();for(let r of i)o.children.has(r)||o.children.set(r,new S),o=o.children.get(r);o.isEndOfWord=!0,o.payload=t,o.word=e}findAllMatches(e){let t=[],o=e.toLowerCase();for(let i=0;i<o.length;i++){let r=this.root,a=i;for(;a<o.length&&r.children.has(o[a]);)if(r=r.children.get(o[a]),a++,r.isEndOfWord){let n=i===0||!Z(o[i-1]),p=a===o.length||!Z(o[a]);n&&p&&t.push({word:r.word||o.substring(i,a),from:i,to:a,payload:r.payload})}}return t}clear(){this.root=new S}},S=class{constructor(){this.children=new Map,this.isEndOfWord=!1,this.payload=null,this.word=null}};function Z(d){return/[a-z0-9]/i.test(d)}var ce=300;var Q=x.StateEffect.define(),de=x.StateField.define({create(){return C.Decoration.none},update(d,e){d=d.map(e.changes);for(let t of e.effects)if(t.is(Q))return C.Decoration.none;return d},provide:d=>C.EditorView.decorations.from(d)}),U=class{constructor(e,t){this.debounceTimer=null;this.lastRanges=[];this.cachedMatches=new Map;this.editorView=e,this.vocabularyManager=t,this.wordTrie=new B,this.buildWordTrie(),this.decorations=this.buildDecorations(e)}buildWordTrie(){let e=performance.now();this.wordTrie.clear();let t=this.vocabularyManager.getAllWords();for(let o of t){let i=this.vocabularyManager.getDefinition(o);i&&this.wordTrie.addWord(o,i)}}update(e){(e.docChanged||e.viewportChanged||e.focusChanged)&&this.debouncedUpdate(e.view)}forceUpdate(){this.buildWordTrie(),this.cachedMatches.clear(),this.decorations=this.buildDecorations(this.editorView),this.editorView.dispatch({effects:Q.of(!0)})}debouncedUpdate(e){this.debounceTimer&&window.clearTimeout(this.debounceTimer),this.debounceTimer=window.setTimeout(()=>{this.decorations=this.buildDecorations(e),this.debounceTimer=null},ce)}buildDecorations(e){let t=performance.now(),o=new x.RangeSetBuilder,i=[],r=e.visibleRanges,a=this.haveRangesChanged(r),n=r.map(l=>`${l.from}-${l.to}`).join(",");if(!a&&this.cachedMatches.has(n)){let l=this.cachedMatches.get(n);return this.applyDecorations(o,l),o.finish()}this.lastRanges=r.map(l=>({from:l.from,to:l.to}));for(let{from:l,to:c}of e.visibleRanges){let h=e.state.sliceDoc(l,c);i.push(...this.findWordMatches(h,l))}i.sort((l,c)=>l.from-c.from);let p=this.removeOverlaps(i);return this.cachedMatches.set(n,p),this.applyDecorations(o,p),o.finish()}applyDecorations(e,t){let o=this.vocabularyManager.getSettings().highlightStyle||"underline";t.forEach(i=>{let r=T(i.definition.color,"var(--color-base-60)");e.add(i.from,i.to,C.Decoration.mark({class:"hi-words-highlight",attributes:{"data-word":i.word,"data-definition":i.definition.definition,"data-color":r,"data-style":o,style:`--word-highlight-color: ${r};`}}))})}haveRangesChanged(e){if(this.lastRanges.length!==e.length)return!0;for(let t=0;t<e.length;t++)if(e[t].from!==this.lastRanges[t].from||e[t].to!==this.lastRanges[t].to)return!0;return!1}findWordMatches(e,t){let o=performance.now(),i=[];try{let r=this.wordTrie.findAllMatches(e);for(let a of r){let n=a.payload;n&&i.push({word:a.word,definition:n,from:t+a.from,to:t+a.to,color:T(n.color,"var(--color-accent)")})}}catch(r){console.error("\u5728 findWordMatches \u4E2D\u53D1\u751F\u9519\u8BEF:",r)}return i}removeOverlaps(e){return e}escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}destroy(){this.debounceTimer&&(window.clearTimeout(this.debounceTimer),this.debounceTimer=null),this.cachedMatches.clear(),this.wordTrie.clear()}};function ee(d){let e={decorations:o=>o.decorations};class t extends U{constructor(i){super(i,d)}}return[de,C.ViewPlugin.fromClass(t,e)]}var F=require("obsidian");var te={plugin_name:"HiWords",settings:{vocabulary_books:"Vocabulary books",add_vocabulary_book:"Add vocabulary book",remove_vocabulary_book:"Remove",show_definition_on_hover:"Show definition on hover",show_definition_on_hover_desc:"Show word definition when hovering over highlighted words",enable_auto_highlight:"Enable auto highlight",enable_auto_highlight_desc:"Automatically highlight words from vocabulary books while reading",highlight_style:"Highlight style",highlight_style_desc:"Choose how words are highlighted in text",style_underline:"Underline",style_background:"Background",style_bold:"Bold",style_dotted:"Dotted underline",style_wavy:"Wavy underline",save_settings:"Save settings",no_vocabulary_books:"No vocabulary books yet. Please add a Canvas file as a vocabulary book.",path:"Path",reload_book:"Reload this vocabulary book",statistics:"Statistics",total_books:"Total vocabulary books: {0}",enabled_books:"Enabled vocabulary books: {0}",total_words:"Total words: {0}"},sidebar:{title:"Vocabulary",empty_state:"No words found. Add words to your vocabulary books to see them here.",source_prefix:"From: ",found:"Found",words:"words",no_definition:"No definition available."},commands:{refresh_vocabulary:"Refresh vocabulary",add_word:"Add word to vocabulary",edit_word:"Edit word",show_sidebar:"Show HiWords sidebar"},notices:{vocabulary_refreshed:"Vocabulary books refreshed",word_added:"Word added to vocabulary book",word_exists:"Word already exists in vocabulary book",error_adding_word:"Error adding word to vocabulary book",select_book_required:"Please select a vocabulary book",adding_word:"Adding word to vocabulary book...",updating_word:"Updating word...",word_added_success:'Word "{0}" successfully added to vocabulary book',word_updated_success:'Word "{0}" successfully updated',add_word_failed:"Failed to add word, please check the vocabulary book file",update_word_failed:"Failed to update word, please check the vocabulary book file",error_processing_word:"Error processing word",no_canvas_files:"No Canvas files found",book_already_exists:"This vocabulary book already exists",invalid_canvas_file:"Invalid Canvas file",book_added:"Added vocabulary book: {0}",book_reloaded:"Reloaded vocabulary book: {0}",book_removed:"Removed vocabulary book: {0}"},modals:{add_word_title:"Add ",edit_word_title:"Edit ",word_label:"Word",definition_label:"Definition",book_label:"Vocabulary book",select_book:"Select a vocabulary book",color_label:"Card color",color_gray:"Gray",color_red:"Red",color_orange:"Orange",color_yellow:"Yellow",color_green:"Green",color_blue:"Blue",color_purple:"Purple",aliases_label:"Aliases (optional, comma separated)",aliases_placeholder:"e.g.: doing, done, did",definition_placeholder:"Enter word definition...",add_button:"Add",save_button:"Save",cancel_button:"Cancel",select_canvas_file:"Select vocabulary book file"}};var oe={plugin_name:"\u751F\u8BCD\u672C",settings:{vocabulary_books:"\u751F\u8BCD\u672C",add_vocabulary_book:"\u6DFB\u52A0\u751F\u8BCD\u672C",remove_vocabulary_book:"\u79FB\u9664",show_definition_on_hover:"\u60AC\u505C\u663E\u793A\u91CA\u4E49",show_definition_on_hover_desc:"\u9F20\u6807\u60AC\u505C\u5728\u9AD8\u4EAE\u8BCD\u6C47\u4E0A\u65F6\u663E\u793A\u5B9A\u4E49",enable_auto_highlight:"\u542F\u7528\u81EA\u52A8\u9AD8\u4EAE",enable_auto_highlight_desc:"\u5728\u9605\u8BFB\u65F6\u81EA\u52A8\u9AD8\u4EAE\u751F\u8BCD\u672C\u4E2D\u7684\u8BCD\u6C47",highlight_style:"\u9AD8\u4EAE\u6837\u5F0F",highlight_style_desc:"\u9009\u62E9\u5355\u8BCD\u5728\u6587\u672C\u4E2D\u7684\u9AD8\u4EAE\u663E\u793A\u65B9\u5F0F",style_underline:"\u4E0B\u5212\u7EBF",style_background:"\u80CC\u666F\u9AD8\u4EAE",style_bold:"\u7C97\u4F53",style_dotted:"\u70B9\u72B6\u4E0B\u5212\u7EBF",style_wavy:"\u6CE2\u6D6A\u7EBF",save_settings:"\u4FDD\u5B58\u8BBE\u7F6E",no_vocabulary_books:"\u6682\u65E0\u751F\u8BCD\u672C\uFF0C\u8BF7\u6DFB\u52A0 Canvas \u6587\u4EF6\u4F5C\u4E3A\u751F\u8BCD\u672C",path:"\u8DEF\u5F84",reload_book:"\u91CD\u65B0\u89E3\u6790\u8BE5\u751F\u8BCD\u672C",statistics:"\u7EDF\u8BA1\u4FE1\u606F",total_books:"\u603B\u751F\u8BCD\u672C\u6570\u91CF: {0}",enabled_books:"\u5DF2\u542F\u7528\u751F\u8BCD\u672C: {0}",total_words:"\u603B\u8BCD\u6C47\u6570\u91CF: {0}"},sidebar:{title:"\u751F\u8BCD\u672C",empty_state:"\u672A\u627E\u5230\u5355\u8BCD\u3002\u6DFB\u52A0\u5355\u8BCD\u5230\u60A8\u7684\u751F\u8BCD\u672C\u4EE5\u5728\u6B64\u5904\u67E5\u770B\u3002",source_prefix:"\u6765\u81EA: ",found:"\u53D1\u73B0",words:"\u4E2A\u751F\u8BCD",no_definition:"\u6682\u65E0\u5B9A\u4E49"},commands:{refresh_vocabulary:"\u5237\u65B0\u751F\u8BCD\u672C",add_word:"\u6DFB\u52A0\u5355\u8BCD\u5230\u751F\u8BCD\u672C",edit_word:"\u7F16\u8F91\u5355\u8BCD",show_sidebar:"\u663E\u793A HiWords \u4FA7\u8FB9\u680F"},notices:{vocabulary_refreshed:"\u751F\u8BCD\u672C\u5DF2\u5237\u65B0",word_added:"\u5355\u8BCD\u5DF2\u6DFB\u52A0\u5230\u751F\u8BCD\u672C",word_exists:"\u5355\u8BCD\u5DF2\u5B58\u5728\u4E8E\u751F\u8BCD\u672C\u4E2D",error_adding_word:"\u6DFB\u52A0\u5355\u8BCD\u5230\u751F\u8BCD\u672C\u65F6\u51FA\u9519",select_book_required:"\u8BF7\u9009\u62E9\u751F\u8BCD\u672C",adding_word:"\u6B63\u5728\u6DFB\u52A0\u8BCD\u6C47\u5230\u751F\u8BCD\u672C...",updating_word:"\u6B63\u5728\u66F4\u65B0\u8BCD\u6C47...",word_added_success:'\u8BCD\u6C47 "{0}" \u5DF2\u6210\u529F\u6DFB\u52A0\u5230\u751F\u8BCD\u672C',word_updated_success:'\u8BCD\u6C47 "{0}" \u5DF2\u6210\u529F\u66F4\u65B0',add_word_failed:"\u6DFB\u52A0\u8BCD\u6C47\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u751F\u8BCD\u672C\u6587\u4EF6",update_word_failed:"\u66F4\u65B0\u8BCD\u6C47\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u751F\u8BCD\u672C\u6587\u4EF6",error_processing_word:"\u5904\u7406\u8BCD\u6C47\u65F6\u51FA\u9519",no_canvas_files:"\u672A\u627E\u5230 Canvas \u6587\u4EF6",book_already_exists:"\u8BE5\u751F\u8BCD\u672C\u5DF2\u5B58\u5728",invalid_canvas_file:"\u65E0\u6548\u7684 Canvas \u6587\u4EF6",book_added:"\u5DF2\u6DFB\u52A0\u751F\u8BCD\u672C: {0}",book_reloaded:"\u5DF2\u91CD\u65B0\u52A0\u8F7D: {0}",book_removed:"\u5DF2\u5220\u9664\u751F\u8BCD\u672C: {0}"},modals:{add_word_title:"\u6DFB\u52A0 ",edit_word_title:"\u7F16\u8F91 ",word_label:"\u8BCD\u6C47",definition_label:"\u91CA\u4E49",book_label:"\u751F\u8BCD\u672C",select_book:"\u9009\u62E9\u751F\u8BCD\u672C",color_label:"\u5361\u7247\u989C\u8272",color_gray:"\u7070\u8272",color_red:"\u7EA2\u8272",color_orange:"\u6A59\u8272",color_yellow:"\u9EC4\u8272",color_green:"\u7EFF\u8272",color_blue:"\u84DD\u8272",color_purple:"\u7D2B\u8272",aliases_label:"\u522B\u540D\uFF08\u53EF\u9009\uFF0C\u7528\u9017\u53F7\u5206\u9694\uFF09",aliases_placeholder:"\u4F8B\u5982\uFF1Adoing, done, did",definition_placeholder:"\u8F93\u5165\u8BCD\u6C47\u91CA\u4E49...",add_button:"\u6DFB\u52A0",save_button:"\u4FDD\u5B58",cancel_button:"\u53D6\u6D88",select_canvas_file:"\u9009\u62E9 Canvas \u6587\u4EF6"}};var he={en:te,zh:oe},q=class d{constructor(){this.app=null}static getInstance(){return d.instance||(d.instance=new d),d.instance}setApp(e){this.app=e}getCurrentLocale(){return(window.localStorage.getItem("language")||"en").startsWith("zh")?"zh":"en"}t(e){let t=this.getCurrentLocale(),o=he[t],i=e.split("."),r=o;for(let a of i)if(r&&r[a]!==void 0)r=r[a];else return console.warn(`\u7FFB\u8BD1\u952E ${e} \u4E0D\u5B58\u5728\u4E8E ${t} \u8BED\u8A00\u5305\u4E2D`),e;return r}},j=q.getInstance(),s=d=>j.t(d);var H=class{constructor(e){this.activeTooltip=null;this.vocabularyManager=null;this.eventHandlers={};this.app=e,this.eventHandlers={mouseover:this.handleMouseOver.bind(this),mouseout:this.handleMouseOut.bind(this)},this.registerEvents()}simpleMarkdownToHtml(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/^### (.*?)$/gm,"<h3>$1</h3>").replace(/^## (.*?)$/gm,"<h2>$1</h2>").replace(/^# (.*?)$/gm,"<h1>$1</h1>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/__(.*?)__/g,"<strong>$1</strong>").replace(/_(.*?)_/g,"<em>$1</em>").replace(/\[([^\]]+)\]\(([^\)]+)\)/g,'<a href="$2" target="_blank">$1</a>').replace(/^\* (.*?)$/gm,"<li>$1</li>").replace(/^\d+\. (.*?)$/gm,"<li>$1</li>").replace(/^> (.*?)$/gm,"<blockquote>$1</blockquote>").replace(/`(.*?)`/g,"<code>$1</code>").replace(/\n/g,"<br>"):""}setContentSafely(e,t){for(;e.firstChild;)e.removeChild(e.firstChild);let o=a=>{let n=a.match(/^(#{1,3}) (.+)$/gm);return n&&n.forEach(p=>{let[l,c,h]=p.match(/^(#{1,3}) (.+)$/)||[];if(c&&h){let u=c.length,g=document.createElement(`h${u}`);g.textContent=h,e.appendChild(g),a=a.replace(p,"")}}),a},i=a=>{if(!a.trim())return;a=a.replace(/\*\*(.*?)\*\*/g,(p,l)=>{let c=document.createElement("strong");return c.textContent=l,`[STRONG]${l}[/STRONG]`}),a=a.replace(/\*(.*?)\*/g,(p,l)=>{let c=document.createElement("em");return c.textContent=l,`[EM]${l}[/EM]`}),a=a.replace(/\[([^\]]+)\]\(([^\)]+)\)/g,(p,l,c)=>{let h=document.createElement("a");return h.href=c,h.textContent=l,h.target="_blank",`[LINK:${c}]${l}[/LINK]`}),a=a.replace(/`(.*?)`/g,(p,l)=>{let c=document.createElement("code");return c.textContent=l,`[CODE]${l}[/CODE]`}),a.split(`
`).forEach(p=>{if(!p.trim())return;let l=document.createElement("p"),c=p;c=c.replace(/\[STRONG\](.*?)\[\/STRONG\]/g,(h,u)=>{let g=document.createElement("strong");return g.textContent=u,l.appendChild(g),""}),c=c.replace(/\[EM\](.*?)\[\/EM\]/g,(h,u)=>{let g=document.createElement("em");return g.textContent=u,l.appendChild(g),""}),c=c.replace(/\[LINK:(.*?)\](.*?)\[\/LINK\]/g,(h,u,g)=>{let v=document.createElement("a");return v.href=u,v.textContent=g,v.target="_blank",l.appendChild(v),""}),c=c.replace(/\[CODE\](.*?)\[\/CODE\]/g,(h,u)=>{let g=document.createElement("code");return g.textContent=u,l.appendChild(g),""}),c.trim()&&l.appendChild(document.createTextNode(c)),l.hasChildNodes()&&e.appendChild(l)})},r=o(t);i(r)}setVocabularyManager(e){this.vocabularyManager=e}registerEvents(){document.addEventListener("mouseover",this.eventHandlers.mouseover),document.addEventListener("mouseout",this.eventHandlers.mouseout)}handleMouseOver(e){let t=e.target;if(t&&t.classList.contains("hi-words-highlight")){let o=t.getAttribute("data-word"),i=t.getAttribute("data-definition");o&&i&&this.createTooltip(t,o,i)}}handleMouseOut(e){this.removeTooltip()}createTooltip(e,t,o){this.removeTooltip();let i=document.createElement("div");i.className="hi-words-tooltip";let r=document.createElement("div");r.className="hi-words-tooltip-title",r.textContent=t,i.appendChild(r);let a=document.createElement("div");if(a.className="hi-words-tooltip-content",!o||o.trim()==="")a.textContent=s("sidebar.no_definition"),i.appendChild(a);else{i.appendChild(a);try{let c=this.app.workspace.getActiveViewOfType(F.MarkdownView);if(c&&c.file)F.MarkdownRenderer.renderMarkdown(o,a,c.file.path,c);else{let h=this.simpleMarkdownToHtml(o);this.setContentSafely(a,h)}}catch(c){console.error("Markdown \u6E32\u67D3\u5931\u8D25:",c),a.textContent=o}}if(this.vocabularyManager){let c=this.vocabularyManager.getDefinition(t);if(c&&c.source){let h=document.createElement("div");h.className="hi-words-tooltip-source";let u=c.source.split("/").pop()||"",g=u.endsWith(".canvas")?u.slice(0,-7):u;h.textContent=`${s("sidebar.source_prefix")}${g}`,i.appendChild(h)}}document.body.appendChild(i);let n=e.getBoundingClientRect();i.style.left=n.left+"px",i.style.top=n.bottom+5+"px";let p=window.pageYOffset||document.documentElement.scrollTop,l=window.pageXOffset||document.documentElement.scrollLeft;i.style.left=n.left+l+"px",i.style.top=n.bottom+p+5+"px",setTimeout(()=>{let c=i.getBoundingClientRect(),h=window.innerWidth;if(c.right>h-10){let u=c.right-h+10;i.style.left=parseFloat(i.style.left)-u+"px"}},0),this.activeTooltip=i}removeTooltip(){this.activeTooltip&&this.activeTooltip.parentNode&&(this.activeTooltip.parentNode.removeChild(this.activeTooltip),this.activeTooltip=null)}unload(){document.removeEventListener("mouseover",this.eventHandlers.mouseover),document.removeEventListener("mouseout",this.eventHandlers.mouseout),this.removeTooltip()}};var f=require("obsidian");var L=class extends f.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty(),this.addBasicSettings(),this.addVocabularyBooksSection()}addBasicSettings(){let{containerEl:e}=this;new f.Setting(e).setName(s("settings.enable_auto_highlight")).setDesc(s("settings.enable_auto_highlight_desc")).addToggle(t=>t.setValue(this.plugin.settings.enableAutoHighlight).onChange(async o=>{this.plugin.settings.enableAutoHighlight=o,await this.plugin.saveSettings(),this.plugin.refreshHighlighter()})),new f.Setting(e).setName(s("settings.show_definition_on_hover")).setDesc(s("settings.show_definition_on_hover_desc")).addToggle(t=>t.setValue(this.plugin.settings.showDefinitionOnHover).onChange(async o=>{this.plugin.settings.showDefinitionOnHover=o,await this.plugin.saveSettings()})),new f.Setting(e).setName(s("settings.highlight_style")).setDesc(s("settings.highlight_style_desc")).addDropdown(t=>t.addOption("underline",s("settings.style_underline")).addOption("background",s("settings.style_background")).addOption("bold",s("settings.style_bold")).addOption("dotted",s("settings.style_dotted")).addOption("wavy",s("settings.style_wavy")).setValue(this.plugin.settings.highlightStyle).onChange(async o=>{this.plugin.settings.highlightStyle=o,await this.plugin.saveSettings(),this.plugin.refreshHighlighter()}))}addVocabularyBooksSection(){let{containerEl:e}=this;new f.Setting(e).setName(s("settings.vocabulary_books")).setHeading(),new f.Setting(e).setName(s("settings.add_vocabulary_book")).setDesc("").addButton(t=>t.setIcon("plus-circle").setTooltip(s("settings.add_vocabulary_book")).onClick(()=>this.showCanvasFilePicker())),this.displayVocabularyBooks(),this.displayStats()}async showCanvasFilePicker(){let e=this.app.vault.getFiles().filter(o=>o.extension==="canvas");if(e.length===0){new f.Notice(s("notices.no_canvas_files"));return}new K(this.app,e,async o=>{await this.addVocabularyBook(o)}).open()}async addVocabularyBook(e){if(this.plugin.settings.vocabularyBooks.some(a=>a.path===e.path)){new f.Notice(s("notices.book_already_exists"));return}if(!await new _(this.app).validateCanvasFile(e)){new f.Notice(s("notices.invalid_canvas_file"));return}let r={path:e.path,name:e.basename,enabled:!0};this.plugin.settings.vocabularyBooks.push(r),await this.plugin.saveSettings(),await this.plugin.vocabularyManager.loadVocabularyBook(r),this.plugin.refreshHighlighter(),new f.Notice(s("notices.book_added").replace("{0}",r.name)),this.display()}displayVocabularyBooks(){let{containerEl:e}=this;if(this.plugin.settings.vocabularyBooks.length===0){e.createEl("p",{text:s("settings.no_vocabulary_books"),cls:"setting-item-description"});return}this.plugin.settings.vocabularyBooks.forEach((t,o)=>{let i=new f.Setting(e).setName(t.name).setDesc(`${s("settings.path")}: ${t.path}`);i.addButton(r=>r.setIcon("refresh-cw").setTooltip(s("settings.reload_book")).onClick(async()=>{await this.plugin.vocabularyManager.reloadVocabularyBook(t.path),this.plugin.refreshHighlighter(),new f.Notice(s("notices.book_reloaded").replace("{0}",t.name))})),i.addButton(r=>r.setIcon("trash").setTooltip(s("settings.remove_vocabulary_book")).setWarning().onClick(async()=>{this.plugin.settings.vocabularyBooks.splice(o,1),await this.plugin.saveSettings(),await this.plugin.vocabularyManager.loadAllVocabularyBooks(),this.plugin.refreshHighlighter(),new f.Notice(s("notices.book_removed").replace("{0}",t.name)),this.display()})),i.addToggle(r=>r.setValue(t.enabled).onChange(async a=>{t.enabled=a,await this.plugin.saveSettings(),a?await this.plugin.vocabularyManager.loadVocabularyBook(t):await this.plugin.vocabularyManager.loadAllVocabularyBooks(),this.plugin.refreshHighlighter()}))})}displayStats(){let{containerEl:e}=this,t=this.plugin.vocabularyManager.getStats();new f.Setting(e).setName(s("settings.statistics")).setHeading();let o=e.createEl("div",{cls:"hi-words-stats"});o.createEl("p",{text:s("settings.total_books").replace("{0}",t.totalBooks.toString())}),o.createEl("p",{text:s("settings.enabled_books").replace("{0}",t.enabledBooks.toString())}),o.createEl("p",{text:s("settings.total_words").replace("{0}",t.totalWords.toString())})}},K=class extends f.Modal{constructor(e,t,o){super(e),this.files=t,this.onSelect=o}onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:s("modals.select_canvas_file")}),this.files.forEach(t=>{let o=e.createEl("div",{cls:"canvas-picker-item"}),i=o.createEl("div",{text:t.basename,cls:"canvas-picker-name"}),r=o.createEl("div",{text:t.path,cls:"canvas-picker-path"});o.addEventListener("click",()=>{this.onSelect(t),this.close()})})}onClose(){let{contentEl:e}=this;e.empty()}};var y=require("obsidian");var V="hi-words-sidebar",N=class extends y.ItemView{constructor(t,o){super(t);this.currentWords=[];this.currentFile=null;this.lastActiveMarkdownView=null;this.plugin=o}getViewType(){return V}getDisplayText(){return s("sidebar.title")}getIcon(){return"book-open"}async onOpen(){let t=this.containerEl.children[1];t.empty(),t.addClass("hi-words-sidebar");let o=t.createEl("div",{cls:"hi-words-sidebar-content"});this.updateView(),this.registerEvent(this.app.workspace.on("active-leaf-change",()=>{this.updateView()})),this.registerEvent(this.app.workspace.on("editor-change",()=>{setTimeout(()=>this.updateView(),500)}))}async onClose(){}async updateView(){let t=this.app.workspace.getActiveFile();if(!t||t.extension!=="md"){this.showEmptyState("\u8BF7\u6253\u5F00\u4E00\u4E2A Markdown \u6587\u6863");return}let o=this.app.workspace.getActiveViewOfType(y.MarkdownView);o&&(this.lastActiveMarkdownView=o),!(t===this.currentFile&&this.currentWords.length>0)&&(this.currentFile=t,await this.scanCurrentDocument(),this.renderWordList())}async scanCurrentDocument(){if(this.currentFile)try{let t=await this.app.vault.read(this.currentFile),o=[],i=this.plugin.vocabularyManager.getAllWords();for(let r of i)if(new RegExp(`\\b${this.escapeRegExp(r)}\\b`,"gi").test(t)){let n=this.plugin.vocabularyManager.getDefinition(r);n&&(o.some(p=>p.word===n.word)||o.push(n))}o.sort((r,a)=>r.word.localeCompare(a.word)),this.currentWords=o}catch(t){console.error("Failed to scan document:",t),this.currentWords=[]}}renderWordList(){let t=this.containerEl.querySelector(".hi-words-sidebar-content");if(!t)return;if(t.empty(),this.currentWords.length===0){this.showEmptyState(s("sidebar.empty_state"));return}t.createEl("div",{cls:"hi-words-sidebar-stats"}).createEl("span",{text:`${s("sidebar.found")} ${this.currentWords.length} ${s("sidebar.words")}`,cls:"hi-words-stats-text"});let i=t.createEl("div",{cls:"hi-words-word-list"});this.currentWords.forEach(r=>{this.createWordCard(i,r)})}createWordCard(t,o){let i=t.createEl("div",{cls:"hi-words-word-card"}),r=T(o.color,"var(--color-base-60)");if(i.style.borderLeftColor=r,o.color){i.style.setProperty("--word-card-accent-color",r);let l=X(r,.1);i.style.setProperty("--word-card-bg-color",l)}if(i.createEl("div",{cls:"hi-words-word-title"}).createEl("span",{text:o.word,cls:"hi-words-word-text"}),o.definition&&o.definition.trim()){let c=i.createEl("div",{cls:"hi-words-word-definition"}).createEl("div",{cls:"hi-words-definition"});try{let h=this.app.workspace.getActiveViewOfType(y.MarkdownView)||this.lastActiveMarkdownView;h&&h.file?y.MarkdownRenderer.renderMarkdown(o.definition,c,h.file.path,h):c.textContent=o.definition}catch(h){console.error("Markdown \u6E32\u67D3\u5931\u8D25:",h),c.textContent=o.definition}}let n=i.createEl("div",{cls:"hi-words-word-source"}),p=this.getBookNameFromPath(o.source);n.createEl("span",{text:`${s("sidebar.source_prefix")}${p}`,cls:"hi-words-source-text"}),i.onmouseenter=()=>{i.addClass("hi-words-word-card-hover")},i.onmouseleave=()=>{i.removeClass("hi-words-word-card-hover")}}showEmptyState(t){let o=this.containerEl.querySelector(".hi-words-sidebar-content");if(!o)return;o.empty(),o.createEl("div",{cls:"hi-words-empty-state"}).createEl("div",{text:t,cls:"hi-words-empty-text"})}getBookNameFromPath(t){var i;let o=this.plugin.settings.vocabularyBooks.find(r=>r.path===t);return o?o.name:((i=t.split("/").pop())==null?void 0:i.replace(".canvas",""))||"\u672A\u77E5"}truncateText(t,o){return t.length<=o?t:t.substring(0,o).trim()}escapeRegExp(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}async openVocabularyBook(t){let o=this.app.vault.getAbstractFileByPath(t.source);o instanceof y.TFile&&await this.app.workspace.openLinkText(o.path,"")}refresh(){this.currentFile=null,this.updateView()}};var b=require("obsidian");var A=class extends b.Modal{constructor(e,t,o,i=!1){super(e),this.plugin=t,this.word=o,this.isEditMode=i,i?this.definition=this.plugin.vocabularyManager.getDefinition(o):this.definition=null}onOpen(){let{contentEl:e}=this;e.empty();let t=this.isEditMode?"modals.edit_word_title":"modals.add_word_title";e.createEl("h2",{text:`${s(t)} "${this.word}"`});let o=e.createDiv({cls:"form-item"});o.createEl("label",{text:s("modals.book_label"),cls:"form-item-label"});let i=o.createEl("select",{cls:"dropdown"});i.createEl("option",{text:s("modals.select_book"),value:""}),this.plugin.settings.vocabularyBooks.forEach(m=>{if(m.enabled){let M=i.createEl("option",{text:m.name,value:m.path});this.isEditMode&&this.definition&&this.definition.source===m.path&&(M.selected=!0)}}),this.isEditMode&&this.definition&&(i.disabled=!0);let r=e.createDiv({cls:"form-item"});r.createEl("label",{text:s("modals.color_label"),cls:"form-item-label"});let a=r.createEl("select",{cls:"dropdown setting-item-select"});a.createEl("option",{text:s("modals.color_gray"),value:""}),[{name:s("modals.color_red"),value:"1"},{name:s("modals.color_orange"),value:"2"},{name:s("modals.color_yellow"),value:"3"},{name:s("modals.color_green"),value:"4"},{name:s("modals.color_blue"),value:"5"},{name:s("modals.color_purple"),value:"6"}].forEach(m=>{let M=a.createEl("option",{text:m.name,value:m.value});this.isEditMode&&this.definition&&this.definition.color===m.value&&(M.selected=!0)});let p=e.createDiv({cls:"form-item"});p.createEl("label",{text:s("modals.aliases_label"),cls:"form-item-label"});let l=p.createEl("input",{type:"text",placeholder:s("modals.aliases_placeholder"),cls:"setting-item-input word-aliases-input"});this.isEditMode&&this.definition&&this.definition.aliases&&this.definition.aliases.length>0&&(l.value=this.definition.aliases.join(", "));let c=e.createDiv({cls:"form-item"});c.createEl("label",{text:s("modals.definition_label"),cls:"form-item-label"});let h=c.createEl("textarea",{placeholder:s("modals.definition_placeholder"),cls:"setting-item-input word-definition-input"});h.rows=5,this.isEditMode&&this.definition&&this.definition.definition&&(h.value=this.definition.definition);let u=e.createDiv({cls:"modal-button-container"}),g=u.createEl("button",{text:s("modals.cancel_button")});g.onclick=()=>this.close();let v=this.isEditMode?"modals.save_button":"modals.add_button",k=u.createEl("button",{text:s(v),cls:"mod-cta"});k.onclick=async()=>{let m=i.value,M=h.value,G=a.value?parseInt(a.value):void 0,J=l.value.trim(),W;if(J&&(W=J.split(",").map(w=>w.trim().toLowerCase()),W=W.filter(w=>w.length>0),W.length===0&&(W=void 0)),!m){new b.Notice(s("notices.select_book_required"));return}let P=this.isEditMode?new b.Notice(s("notices.updating_word"),0):new b.Notice(s("notices.adding_word"),0);try{let w=!1;if(this.isEditMode&&this.definition)if(w=await this.plugin.vocabularyManager.updateWordInCanvas(this.definition.source,this.definition.nodeId,this.word,M,G,W),P.hide(),w){let I=s("notices.word_updated_success").replace("{0}",this.word);new b.Notice(I),this.plugin.refreshHighlighter(),this.close()}else new b.Notice(s("notices.update_word_failed"));else if(w=await this.plugin.vocabularyManager.addWordToCanvas(m,this.word,M,G,W),P.hide(),w){let I=s("notices.word_added_success").replace("{0}",this.word);new b.Notice(I),this.plugin.refreshHighlighter(),this.close()}else new b.Notice(s("notices.add_word_failed"))}catch(w){P.hide(),console.error("Failed to add/update word:",w),new b.Notice(s("notices.error_processing_word"))}}}onClose(){let{contentEl:e}=this;e.empty()}};var pe={vocabularyBooks:[],showDefinitionOnHover:!0,enableAutoHighlight:!0,highlightStyle:"underline"},O=class extends E.Plugin{constructor(){super(...arguments);this.editorExtensions=[];this.highlighterInstance=null;this.sidebarView=null;this.isSidebarInitialized=!1}async onload(){await this.loadSettings(),j.setApp(this.app),this.vocabularyManager=new $(this.app,this.settings),this.definitionPopover=new H(this.app),this.definitionPopover.setVocabularyManager(this.vocabularyManager),await this.vocabularyManager.loadAllVocabularyBooks(),this.registerView(V,t=>(this.sidebarView=new N(t,this),this.sidebarView)),this.setupEditorExtensions(),this.registerCommands(),this.registerEvents(),this.addSettingTab(new L(this.app,this)),this.initializeSidebar(),this.app.workspace.onLayoutReady(async()=>{await this.vocabularyManager.loadAllVocabularyBooks(),this.refreshHighlighter()})}setupEditorExtensions(){if(this.settings.enableAutoHighlight){let t=ee(this.vocabularyManager);this.editorExtensions=[t],this.registerEditorExtension(this.editorExtensions)}}registerCommands(){this.addCommand({id:"refresh-vocabulary",name:s("commands.refresh_vocabulary"),callback:async()=>{await this.vocabularyManager.loadAllVocabularyBooks(),this.refreshHighlighter(),new E.Notice(s("notices.vocabulary_refreshed"))}}),this.addCommand({id:"open-vocabulary-sidebar",name:s("commands.show_sidebar"),callback:()=>{this.activateSidebarView()}})}registerEvents(){let t=new Set,o=null;this.registerEvent(this.app.vault.on("modify",i=>{i instanceof E.TFile&&i.extension==="canvas"&&this.settings.vocabularyBooks.some(a=>a.path===i.path)&&t.add(i.path)})),this.registerEvent(this.app.workspace.on("active-leaf-change",async i=>{let r=this.app.workspace.getActiveFile();if(o&&t.has(o)&&(!r||r.path!==o)&&(await this.vocabularyManager.reloadVocabularyBook(o),this.refreshHighlighter(),t.delete(o)),r&&r.extension==="canvas")o=r.path;else if(o=null,t.size>0){let a=Array.from(t);t.clear();for(let n of a)await this.vocabularyManager.reloadVocabularyBook(n);this.refreshHighlighter()}else setTimeout(()=>this.refreshHighlighter(),100)})),this.registerEvent(this.app.workspace.on("editor-menu",(i,r)=>{let a=r.getSelection();if(a&&a.trim()){let n=a.trim(),p=this.vocabularyManager.hasWord(n);i.addItem(l=>{let c=p?"commands.edit_word":"commands.add_word";l.setTitle(s(c)).onClick(()=>{this.addOrEditWord(n)})})}}))}refreshHighlighter(){this.settings.enableAutoHighlight&&this.app.workspace.iterateAllLeaves(t=>{if(t.view instanceof E.MarkdownView){let i=t.view.editor.cm;i&&i.dispatch({effects:[]})}}),this.sidebarView&&this.sidebarView.refresh()}async initializeSidebar(){this.isSidebarInitialized||this.app.workspace.onLayoutReady(()=>{this.isSidebarInitialized=!0})}async activateSidebarView(){let{workspace:t}=this.app,o=null,i=t.getLeavesOfType(V);i.length>0?o=i[0]:(o=t.getRightLeaf(!1),o&&await o.setViewState({type:V,active:!0})),o&&t.revealLeaf(o)}async loadSettings(){this.settings=Object.assign({},pe,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.vocabularyManager.updateSettings(this.settings)}addOrEditWord(t){this.vocabularyManager.hasWord(t)?new A(this.app,this,t,!0).open():new A(this.app,this,t).open()}onunload(){this.definitionPopover.unload(),this.vocabularyManager.clear()}};
