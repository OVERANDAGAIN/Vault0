以下是图片中的文字内容：

---

Our opponent modeling consists of two components: subgoal inference model and subgoal selector.

The subgoal inference model employs the historical trajectory to predict the opponent’s subgoal, serving as input for the policy during the interaction phase. The subgoal selector scrutinizes the entire historical trajectory using a value-based heuristic to choose the appropriate subgoal for training the inference model during the update phase.

Subgoal inference model. The subgoal $g$ represents a feature embedding of a future state. Specifically, for a trajectory $\{s_0, a_0, a_0^{-i}, \ldots, s_t, a_t, a_t^{-i}, \ldots, s_T\}$, the state corresponding to subgoal $g_t$ at $s_t$ is one of future states $\mathcal{N}_t = \{s_{t+1}, s_{t+2}, \ldots, s_T\}$, denoted as $s_t^g$ and determined by the subgoal selector.

The objective of the subgoal inference model is to infer $g_t$ from the historical trajectory $\tau_t = \{s_0, a_0, a_0^{-i}, \ldots, s_{t-1}, a_{t-1}, a_{t-1}^{-i}\}$. This aligns with the intuitive hypothesis that the opponent’s intention can often be inferred after just a few initial actions.

Here, we introduce variational inference and employ a conditional variational auto-encoder (CVAE) as the subgoal inference model. In this model, we represent the subgoal posterior probability as $q_\phi(\hat{g}_t|\tau_t, s_t)$ and the likelihood estimate as $p_\theta(s_t|\hat{g}_t, \tau_t)$ with $\phi$ and $\theta$ respectively denoting the network parameters. The subgoal prior model, denoted as $p_\psi(\hat{g}_t|s_t^g)$, is a pre-trained variational autoencoder (VAE) using the states previously collected in the environment, and produces the subgoal prior $p_\psi(\hat{g}_t|s_t^g)$ given the subgoal state $s_t^g$ chosen by the subgoal selector.

Further details about the network architecture are provided in Figure 2. The optimization objective of the subgoal inference model is:

$$\langle \hat{\theta}, \hat{\phi} \rangle = \arg\max_{\theta, \phi} \mathbb{E}_{q_\phi(\hat{g}_t|\tau_t, s_t)} \left[ \log p_\theta(s_t|\hat{g}_t, \tau_t) \right] - \text{KL} \left( q_\phi(\hat{g}_t|\tau_t, s_t) \parallel p_\psi(\hat{g}_t|s_t^g) \right).$$

---

如需进一步解释其中的内容，请告诉我！