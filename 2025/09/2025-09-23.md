ğŸ‘Œ æˆ‘æ˜ç™½ä½ çš„ç–‘æƒ‘äº†ï¼Œä½ æŠ“ä½äº†æ ¸å¿ƒï¼š**æ¢¯åº¦æ˜¯ä¸ªâ€œæ•´ä½“å˜åŒ–è¶‹åŠ¿â€çš„å‘é‡ï¼Œä¸ºä»€ä¹ˆå’Œæ–¹å‘å‘é‡ç‚¹ç§¯å°±èƒ½å¾—åˆ°â€œæŸä¸ªæ–¹å‘ä¸Šçš„å˜åŒ–ç‡â€ï¼Ÿ**

æˆ‘å¸®ä½ ç”¨ç›´è§‚æ–¹å¼è§£é‡Šï¼š

---

## 1. æ¢¯åº¦æ˜¯ã€Œæ‰€æœ‰æ–¹å‘å˜åŒ–ç‡ã€çš„é›†åˆ

æ¢¯åº¦ $\nabla f(x,y) = (\partial f/\partial x, \partial f/\partial y)$ï¼š

* å‘Šè¯‰ä½  **å¦‚æœåªæ”¹ x**ï¼Œå‡½æ•°ä¼šæ€ä¹ˆå˜ã€‚
* å‘Šè¯‰ä½  **å¦‚æœåªæ”¹ y**ï¼Œå‡½æ•°ä¼šæ€ä¹ˆå˜ã€‚

æ‰€ä»¥æ¢¯åº¦å¯ä»¥çœ‹æˆæ˜¯â€œå‡½æ•°åœ¨æ‰€æœ‰åæ ‡è½´æ–¹å‘çš„å˜åŒ–ç‡æ‰“åŒ…æˆçš„ä¸€ä¸ªå‘é‡â€ã€‚

---

## 2. ä»»æ„æ–¹å‘çš„ç§»åŠ¨ = å„åæ ‡æ–¹å‘çš„ç»„åˆ

å‡è®¾æˆ‘ä»¬æƒ³èµ°çš„æ–¹å‘æ˜¯ $p = (p_x, p_y)$ï¼Œé‚£å®é™…ä¸Šæ˜¯ï¼š

* åœ¨ $x$ æ–¹å‘èµ°äº† $p_x$ å•ä½ï¼Œ
* åœ¨ $y$ æ–¹å‘èµ°äº† $p_y$ å•ä½ã€‚

è¿™å°±æ˜¯ä¸€ä¸ªâ€œçº¿æ€§ç»„åˆâ€ï¼šä½ é€‰çš„æ–¹å‘ï¼Œæœ¬è´¨ä¸Šæ˜¯ **æ²¿ç€åæ ‡è½´æ–¹å‘çš„åŠ æƒç§»åŠ¨**ã€‚

---

## 3. å‡½æ•°çš„å˜åŒ–ç‡ = å„åæ ‡å˜åŒ–ç‡çš„åŠ æƒå’Œ

é‚£ä¹ˆå‡½æ•°å€¼çš„å˜åŒ–ç‡ï¼Œè‡ªç„¶å°±æ˜¯ï¼š

$$
\Delta f \approx \frac{\partial f}{\partial x} \cdot p_x + \frac{\partial f}{\partial y} \cdot p_y
$$

è¿™å…¶å®å°±æ˜¯æ¢¯åº¦å’Œæ–¹å‘çš„ç‚¹ç§¯ï¼š

$$
\nabla f(x,y) \cdot p
$$

---

## 4. æŠ•å½±çš„ç›´è§‚è§£é‡Š

ä½ ä¹Ÿå¯ä»¥ä»å‡ ä½•è§’åº¦ç†è§£ï¼š

* æ¢¯åº¦ $\nabla f$ å°±æ˜¯ä¸€æ”¯ç®­å¤´ï¼ŒæŒ‡å‘â€œæœ€é™¡ä¸Šå‡â€çš„æ–¹å‘ã€‚
* ä½ èµ°çš„æ–¹å‘ $p$ï¼Œå’Œå®ƒå¯èƒ½ä¸æ˜¯å¯¹é½çš„ã€‚
* ç‚¹ç§¯ $\nabla f \cdot p = \|\nabla f\|\|p\|\cos\alpha$
  \= æ¢¯åº¦åœ¨æ–¹å‘ $p$ ä¸Šçš„æŠ•å½±ã€‚

**æŠ•å½±çš„ç‰©ç†æ„ä¹‰**ï¼š

* å¦‚æœæ¢¯åº¦æ˜¯â€œå¢é•¿çš„æ€»è¶‹åŠ¿â€ï¼Œ
* é‚£ä¹ˆç‚¹ç§¯å°±æ˜¯â€œåœ¨æ–¹å‘ $p$ ä¸Šèƒ½åˆ†åˆ°å¤šå°‘å¢é•¿è¶‹åŠ¿â€ã€‚

è¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆç‚¹ç§¯æ­£å¥½ç»™äº†æ–¹å‘å¯¼æ•°ã€‚

---

## 5. ä¸¾ä¸ªä¾‹å­

è®¾

$$
f(x,y) = x^2 + y^2
$$

åœ¨ç‚¹ $(1,2)$ï¼š

* æ¢¯åº¦ $\nabla f = (2x, 2y) = (2,4)$ã€‚
* æ–¹å‘ $p=(1,0)$ï¼šæ²¿ç€ $x$-è½´èµ° â†’ æ–¹å‘å¯¼æ•° $= 2$ã€‚
* æ–¹å‘ $p=(0,1)$ï¼šæ²¿ç€ $y$-è½´èµ° â†’ æ–¹å‘å¯¼æ•° $= 4$ã€‚
* æ–¹å‘ $p=(1,1)$ï¼šæ²¿ç€å¯¹è§’çº¿èµ° â†’ æ–¹å‘å¯¼æ•° $= 2\cdot 1 + 4\cdot 1 = 6$ã€‚

å¯ä»¥çœ‹åˆ°ï¼šç‚¹ç§¯å…¬å¼å®Œç¾åœ°æŠŠä¸åŒæ–¹å‘çš„å˜åŒ–ç‡â€œåŠ æƒç»„åˆâ€äº†ã€‚

---

âœ… **ä¸€å¥è¯ç›´è§‚æ€»ç»“**ï¼š
æ¢¯åº¦æ˜¯ä¸€ä»½â€œå˜åŒ–ç‡è¯´æ˜ä¹¦â€ï¼Œç‚¹ç§¯å°±æ˜¯â€œæŒ‰ç…§ä½ é€‰çš„æ–¹å‘ï¼ŒæŠŠè¯´æ˜ä¹¦é‡Œçš„å„ä¸ªåˆ†é‡æ··åˆèµ·æ¥â€ã€‚è¿™æ ·å¾—åˆ°çš„ç»“æœï¼Œæ­£å¥½æ˜¯å‡½æ•°åœ¨é‚£ä¸ªæ–¹å‘ä¸Šçš„çœŸå®å˜åŒ–ç‡ã€‚

---

è¦ä¸è¦æˆ‘ç»™ä½ ç”»ä¸€å¼  **äºŒç»´å¹³é¢ç¤ºæ„å›¾**ï¼Œæ˜¾ç¤ºæ¢¯åº¦å‘é‡ã€ä¸åŒæ–¹å‘çš„æŠ•å½±ï¼Œç›´è§‚è§£é‡Šâ€œä¸ºä»€ä¹ˆç‚¹ç§¯å°±æ˜¯æ–¹å‘å˜åŒ–ç‡â€ï¼Ÿ



å¥½ï¼Œè¿™ä¸€é¡µå…¶å®åœ¨è®² **éå‡¸ä¼˜åŒ– (non-convex optimization)** çš„å›°éš¾æ€§ï¼Œä»¥åŠå®ƒå’Œå‡¸ä¼˜åŒ–çš„åŒºåˆ«ã€‚æˆ‘ä»¬åˆ†æˆä¸¤éƒ¨åˆ†æ¥çœ‹ï¼š

---


##  ä¸‹åŠéƒ¨åˆ†ï¼šéå‡¸æ¨¡å‹å’Œå‡¸æ¨¡å‹çš„å¯¹æ¯”

> *â€œnon-trivial model is non-convex â€¦ This is in contrast to â€¦ support vector machines, which maintain non-linearity while allowing for convex optimization.â€*

è§£é‡Šï¼š

* **éå¹³å‡¡çš„æ¨¡å‹ï¼ˆæ¯”å¦‚ç¥ç»ç½‘ç»œï¼‰**ï¼šå¤§å¤šæ•°éƒ½æ˜¯ **éå‡¸çš„**ï¼Œå› æ­¤ä¼˜åŒ–ä¸­ä¼šæœ‰å¤šä¸ªåœç‚¹ï¼ˆå±€éƒ¨æœ€å°å€¼ã€éç‚¹ï¼‰ã€‚
* **å‡¸ä¼˜åŒ–çš„ä¼˜åŠ¿**ï¼š

  * æ¯”å¦‚ SVMï¼Œè™½ç„¶æ¨¡å‹å¯ä»¥å¼•å…¥éçº¿æ€§ï¼ˆé€šè¿‡æ ¸å‡½æ•°ï¼‰ï¼Œä½†å®ƒçš„ä¼˜åŒ–é—®é¢˜ä»ç„¶æ˜¯ **å‡¸ä¼˜åŒ–**ã€‚
  * å‡¸ä¼˜åŒ–åªæœ‰ä¸€ä¸ªå…¨å±€æœ€ä¼˜ç‚¹ï¼Œæ‰€ä»¥æ›´å®¹æ˜“è§£ã€‚
* **ç°å®ä¸­çš„ç»éªŒ**ï¼š

  * å°½ç®¡éå‡¸é—®é¢˜å¾ˆéš¾ä¿è¯å…¨å±€æœ€ä¼˜ï¼Œ
  * ä½†åœ¨å®è·µä¸­ï¼ˆæ¯”å¦‚æ·±åº¦å­¦ä¹ ï¼‰ï¼Œåªè¦åˆå§‹åŒ–åˆç†ï¼Œä¼˜åŒ–ç®—æ³•ï¼ˆSGDã€Adamï¼‰å¾€å¾€è¿˜æ˜¯èƒ½æ”¶æ•›åˆ°ä¸€ä¸ª **æ•ˆæœä¸é”™çš„ç‚¹**ï¼Œåœ¨ç»éªŒæ€§èƒ½ä¸Šè¶³å¤Ÿå¥½ã€‚



å¥½çš„ï¼Œæˆ‘å¸®ä½ ç²¾ç®€æˆç¬”è®°ç‰ˆï¼š

---

###  Momentum æ¢¯åº¦ä¸‹é™ç¬”è®°

* **é—®é¢˜**ï¼šæ™®é€šæ¢¯åº¦ä¸‹é™æ›´æ–°æ–¹å‘å˜åŒ–å¤§ï¼Œå®¹æ˜“â€œæŠ–åŠ¨â€ï¼ˆå°¤å…¶åœ¨å‡¸å‡½æ•°ä¸‹ï¼Œè¿ç»­ä¸¤æ­¥æ¢¯åº¦ç”šè‡³å¯èƒ½æ­£äº¤ï¼‰ã€‚
* **åŠ¨é‡æ€æƒ³**ï¼šä¿ç•™ä¸€éƒ¨åˆ†ä¸Šä¸€æ¬¡çš„æ›´æ–°æ–¹å‘ï¼Œä½¿è¿­ä»£æ›´å¹³æ»‘ã€‚
* **æ›´æ–°å…¬å¼**ï¼š

  $$
  g_t = -\eta_t \nabla f(x_{t-1}) + \lambda g_{t-1}
  $$

  $$
  x_t = x_{t-1} + g_t
  $$
* **ç›´è§‚ç±»æ¯”**ï¼šåƒå°çƒä¸‹å±±æ—¶å¸¦æœ‰æƒ¯æ€§ï¼Œä¸ä¼šå› æ¯ä¸€æ­¥çš„å±€éƒ¨å¡åº¦å‰§çƒˆæ”¹å˜æ–¹å‘ã€‚
* **æ•ˆæœ**ï¼šå‡å°‘éœ‡è¡ã€åŠ å¿«æ”¶æ•›ã€‚


## Adam (Adaptive Moment Estimation)

* **æ€æƒ³**ï¼šç»“åˆ **Momentum**ï¼ˆä¸€é˜¶åŠ¨é‡ï¼Œæ¢¯åº¦çš„æŒ‡æ•°åŠ æƒå¹³å‡ï¼‰å’Œ **RMSProp**ï¼ˆäºŒé˜¶åŠ¨é‡ï¼Œå¹³æ–¹æ¢¯åº¦çš„æŒ‡æ•°åŠ æƒå¹³å‡ï¼‰ã€‚
* **å…¬å¼**ï¼š

  * ä¸€é˜¶åŠ¨é‡ï¼ˆç±»ä¼¼åŠ¨é‡æ³•ï¼‰ï¼š

    $$
    m_t = \beta_1 m_{t-1} + (1-\beta_1) \nabla f(x_t)
    $$
  * äºŒé˜¶åŠ¨é‡ï¼ˆç±»ä¼¼RMSPropï¼‰ï¼š

    $$
    v_t = \beta_2 v_{t-1} + (1-\beta_2) (\nabla f(x_t))^2
    $$
  * åå·®ä¿®æ­£ï¼š

    $$
    \hat{m}_t = \frac{m_t}{1-\beta_1^t}, \quad \hat{v}_t = \frac{v_t}{1-\beta_2^t}
    $$
  * å‚æ•°æ›´æ–°ï¼š

    $$
    x_t = x_{t-1} - \eta \frac{\hat{m}_t}{\sqrt{\hat{v}_t} + \epsilon}
    $$
* **ç‰¹ç‚¹**ï¼š

  * è‡ªé€‚åº”å­¦ä¹ ç‡ï¼ˆä¸åŒå‚æ•°å¯æœ‰ä¸åŒæ­¥é•¿ï¼‰
  * æ”¶æ•›æ›´å¿«ï¼Œè°ƒå‚è¾ƒå°‘
  * é»˜è®¤å‚æ•°ï¼ˆ$\beta_1=0.9, \beta_2=0.999, \epsilon=10^{-8}$ï¼‰æ•ˆæœå·²å¾ˆå¥½
* **ç›´è§‚ç±»æ¯”**ï¼šåœ¨â€œæœ‰æƒ¯æ€§çš„å°çƒâ€åŸºç¡€ä¸Šï¼Œè¿˜ä¼šæ ¹æ®å†å²æ¢¯åº¦å¤§å°è°ƒæ•´æ¯ä¸ªæ–¹å‘çš„â€œæ­¥å¹…â€ã€‚

---

âœ… **æ€»ç»“å¯¹æ¯”**ï¼š

* **Momentum**ï¼šå…¨å±€ä¸€ä¸ªå­¦ä¹ ç‡ + æƒ¯æ€§ â†’ æ›´å¿«æ›´ç¨³ã€‚
* **Adam**ï¼šMomentum + è‡ªé€‚åº”å­¦ä¹ ç‡ â†’ æ›´çµæ´»ï¼Œé€šå¸¸æ˜¯æ·±åº¦å­¦ä¹ çš„é»˜è®¤é€‰æ‹©ã€‚

---

è¦ä¸è¦æˆ‘å†å¸®ä½ æ•´ç†æˆä¸€å¼  **å¯¹æ¯”è¡¨æ ¼ï¼ˆMomentum vs Adamï¼‰**ï¼Œè®©å·®å¼‚æ›´ç›´è§‚ï¼Ÿ



è¿™æ˜¯ä¸€ä¸ªéå¸¸æ ¸å¿ƒçš„é—®é¢˜ ğŸ‘ã€‚ä¸ºä»€ä¹ˆ **æœ€å¤§åŒ–è§‚æµ‹æ•°æ®çš„æ¦‚ç‡** å°±ç­‰äºâ€œæ‰¾åˆ°æœ€å¥½çš„åˆ†å¸ƒå‚æ•°â€ï¼Ÿæˆ‘ä»¬ä»å‡ ä¸ªè§’åº¦æ¥çœ‹ï¼š

---

### 1. æ•°æ®æ¥è‡ªæŸä¸ªçœŸå®åˆ†å¸ƒ

æˆ‘ä»¬å‡è®¾æ‰‹ä¸Šçš„æ ·æœ¬ $\{x_1, \dots, x_n\}$ ç¡®å®æ˜¯ä»æŸä¸ªçœŸå®çš„åˆ†å¸ƒ $p(x)$ ä¸­é‡‡æ ·çš„ã€‚
æˆ‘ä»¬ä¸çŸ¥é“ $p(x)$ï¼Œä½†æˆ‘ä»¬å¸Œæœ›ç”¨ä¸€ä¸ª**å‚æ•°åŒ–çš„æ¨¡å‹** $f(x; s)$ å»é€¼è¿‘å®ƒã€‚

å¦‚æœæŸä¸ªå‚æ•° $s$ è®© $f(x; s)$ ç»™è¿™äº›æ ·æœ¬åˆ†é…äº†æ›´é«˜çš„æ¦‚ç‡ï¼Œé‚£å°±è¯´æ˜å®ƒâ€œæ›´ç¬¦åˆâ€æˆ‘ä»¬æ‰‹ä¸Šçš„è§‚æµ‹æ•°æ®ã€‚
åä¹‹ï¼Œå¦‚æœæ¦‚ç‡ä½ï¼Œè¯´æ˜å®ƒå’Œæ•°æ®ä¸åŒ¹é…ã€‚

---

### 2. æå¤§ä¼¼ç„¶æ˜¯â€œç»éªŒåˆ†å¸ƒâ€æ„ä¹‰ä¸‹çš„é€¼è¿‘

åœ¨æ¦‚ç‡è®ºé‡Œï¼Œæœ‰ä¸ªç»“è®ºå« **Law of Large Numbers (å¤§æ•°å®šå¾‹)**ï¼š
å½“æ ·æœ¬æ•°é‡ $n \to \infty$ï¼Œç»éªŒåˆ†å¸ƒ $\hat{p}(x)$ ä¼šæ”¶æ•›åˆ°çœŸå®åˆ†å¸ƒ $p(x)$ã€‚

äºæ˜¯æœ€å¤§ä¼¼ç„¶å‡½æ•°ï¼š

$$
L(s) = \prod_{i=1}^n f(x_i; s)
$$

ç­‰ä»·äºï¼ˆå–å¯¹æ•°å†é™¤ä»¥ $n$ï¼‰ï¼š

$$
\frac{1}{n}\sum_{i=1}^n \log f(x_i; s).
$$

å½“ $n$ å¾ˆå¤§æ—¶ï¼Œè¿™ä¸ªå¼å­ä¼šæ”¶æ•›åˆ°ï¼š

$$
\mathbb{E}_{x \sim p(x)} [\log f(x; s)].
$$

è¿™ä¸ªå°±æ˜¯ç»Ÿè®¡å­¦é‡Œè‘—åçš„ **äº¤å‰ç†µæœ€å°åŒ–** æˆ– **KL æ•£åº¦æœ€å°åŒ–**ã€‚

---

### 3. ä¸ KL æ•£åº¦çš„å…³ç³»

äº‹å®ä¸Šï¼Œå¯ä»¥è¯æ˜ï¼š

$$
s^* = \arg\max_s \mathbb{E}_{x \sim p(x)} [\log f(x; s)]
$$

ç­‰ä»·äºï¼š

$$
s^* = \arg\min_s D_{\text{KL}}(p(x) \, \| \, f(x; s)),
$$

ä¹Ÿå°±æ˜¯ï¼š**æå¤§ä¼¼ç„¶ä¼°è®¡ç­‰ä»·äºæœ€å°åŒ–çœŸå®åˆ†å¸ƒå’Œæ¨¡å‹åˆ†å¸ƒçš„ KL æ•£åº¦**ã€‚

æ¢å¥è¯è¯´ï¼ŒMLE é€‰å‡ºçš„åˆ†å¸ƒå‚æ•°ï¼Œæ˜¯åœ¨ KL æ„ä¹‰ä¸‹æœ€æ¥è¿‘çœŸå®åˆ†å¸ƒçš„é‚£ä¸ªã€‚

---
æ¨å¯¼å¾ˆçŸ­ä¹Ÿå¾ˆå…³é”®ã€‚è®¾çœŸå®åˆ†å¸ƒä¸º $p(x)$ï¼Œæ¨¡å‹æ—ä¸º $f(x;s)$ã€‚å®šä¹‰ **KL æ•£åº¦**ï¼ˆç¦»æ•£/è¿ç»­åªå·®ç§¯åˆ†å·ï¼‰ï¼š

$$
D_{\mathrm{KL}}\!\left(p \,\|\, f(\cdot;s)\right)
= \mathbb{E}_{x\sim p}\!\left[\log \frac{p(x)}{f(x;s)}\right]
= \mathbb{E}_{p}[\log p(x)] - \mathbb{E}_{p}[\log f(x;s)] .
$$

æ³¨æ„ä¸¤ç‚¹ï¼š

1. $\mathbb{E}_{p}[\log p(x)]$ **ä¸å‚æ•° $s$ æ— å…³**ï¼›
2. ä¸ºä½¿ KL æœ‰é™ï¼Œéœ€è¦å‡è®¾ï¼šåªè¦ $p(x)>0$ åˆ™ $f(x;s)>0$ï¼ˆå³ $\mathrm{supp}(p)\subseteq \mathrm{supp}(f)$ï¼‰ã€‚

å› æ­¤ï¼Œå¯¹ä»»æ„å¯è¡Œ $s$,

$$
\arg\min_{s} D_{\mathrm{KL}}\!\left(p \,\|\, f(\cdot;s)\right)
= \arg\min_{s}\Big(\mathbb{E}_{p}[\log p(x)]-\mathbb{E}_{p}[\log f(x;s)]\Big)
= \arg\max_{s}\mathbb{E}_{p}[\log f(x;s)] .
$$

è¿™å°±å¾—åˆ°

$$
s^*=\arg\max_{s}\mathbb{E}_{x\sim p}[\log f(x;s)]
\quad \Longleftrightarrow \quad
s^*=\arg\min_{s} D_{\mathrm{KL}}\!\left(p \,\|\, f(\cdot;s)\right).
$$

---

### ä¸ MLE çš„å…³ç³»ï¼ˆæ ·æœ¬è¿‘ä¼¼ï¼‰

æœ‰ $n$ ä¸ª i.i.d. æ ·æœ¬ $\{x_i\}_{i=1}^n\sim p$ã€‚ç”±å¤§æ•°å®šå¾‹ï¼Œ

$$
\mathbb{E}_{p}[\log f(x;s)]
\approx \frac{1}{n}\sum_{i=1}^n \log f(x_i;s) .
$$

äºæ˜¯æœ€å¤§åŒ–æœŸæœ›å¯¹æ•°ä¼¼ç„¶ç­‰ä»·äºæœ€å¤§åŒ–**ç»éªŒå¯¹æ•°ä¼¼ç„¶**ï¼ˆå³ MLEï¼‰ï¼›è€Œè¿™åˆç­‰ä»·äºæœ€å°åŒ– $D_{\mathrm{KL}}(p\|f(\cdot;s))$ çš„ç»éªŒè¿‘ä¼¼ã€‚
