å½“ç„¶ã€‚ä¸‹é¢æ˜¯**å®Œæ•´çš„ MDP ä¸ SMDPï¼ˆoptions æ¡†æ¶ï¼‰Bellman æ–¹ç¨‹**ï¼ŒåŒæ—¶ç»™å‡º **$V$ å‡½æ•°**ä¸**$Q$ å‡½æ•°**çš„æœŸæœ›å½¢å¼ä¸æœ€ä¼˜å½¢å¼ï¼ˆå…¨éƒ¨ä½¿ç”¨ `$` æˆ– `$$` åŒ…è£¹çš„å…¬å¼æ ¼å¼ï¼‰ã€‚

---

## ğŸ§© ä¸€ã€æ™®é€š MDP

### (1) Bellman æœŸæœ›æ–¹ç¨‹ï¼ˆç»™å®šç­–ç•¥ $\pi$ï¼‰

çŠ¶æ€ä»·å€¼å‡½æ•°ï¼š
$$
V^{\pi}(s)=\sum_{a}\pi(a\mid s)\Big[r(s,a)+\gamma\sum_{s'}P(s'\mid s,a)V^{\pi}(s')\Big]
$$

åŠ¨ä½œä»·å€¼å‡½æ•°ï¼š
$$
Q^{\pi}(s,a)=r(s,a)+\gamma\sum_{s'}P(s'\mid s,a)\sum_{a'}\pi(a'\mid s')Q^{\pi}(s',a')
$$

ä¸¤è€…å…³ç³»ï¼š
$$
V^{\pi}(s)=\sum_{a}\pi(a\mid s)Q^{\pi}(s,a)
$$

---

### (2) Bellman æœ€ä¼˜æ–¹ç¨‹ï¼ˆOptimalityï¼‰

çŠ¶æ€ä»·å€¼å‡½æ•°ï¼š
$$
V^{*}(s)=\max_{a}\Big[r(s,a)+\gamma\sum_{s'}P(s'\mid s,a)V^{*}(s')\Big]
$$

åŠ¨ä½œä»·å€¼å‡½æ•°ï¼š
$$
Q^{*}(s,a)=r(s,a)+\gamma\sum_{s'}P(s'\mid s,a)\max_{a'}Q^{*}(s',a')
$$

ä»¥åŠï¼š
$$
V^{*}(s)=\max_{a}Q^{*}(s,a)
$$

---

## ğŸ§© äºŒã€SMDP / Options æ¡†æ¶

è®¾é€‰é¡¹ $o=\langle \mathcal{I},\pi,\beta\rangle$ï¼Œæ‰§è¡Œæ—¶é•¿ä¸ºéšæœºå˜é‡ $k$ã€‚

å®šä¹‰ï¼š
$$
R_{s}^{o}=\mathbb{E}!\left[\sum_{i=0}^{k-1}\gamma^{i}r_{t+i}\mid s,o\right], \quad
p_{ss'}^{o}=\sum_{k\ge1}\gamma^{k}P(s',k\mid s,o)
$$
ï¼ˆè‹¥å†™ä¸ºæ˜¾å¼ $k$ å½¢å¼ï¼Œåˆ™ $p_{ss'}^{o}$ å†…ä¸åŒ…å« $\gamma^{k}$ã€‚ï¼‰

---

### (1) Bellman æœŸæœ›æ–¹ç¨‹ï¼ˆç»™å®šé«˜å±‚ç­–ç•¥ $\mu$ï¼‰

çŠ¶æ€ä»·å€¼å‡½æ•°ï¼š
$$
V^{\mu}(s)=\sum_{o}\mu(o\mid s)\Big[r_{s}^{o}+\sum_{s'}p_{ss'}^{o}V^{\mu}(s')\Big]
$$

é€‰é¡¹ä»·å€¼å‡½æ•°ï¼š
$$
Q^{\mu}(s,o)=r_{s}^{o}+\sum_{s'}p_{ss'}^{o}\sum_{o'}\mu(o'\mid s')Q^{\mu}(s',o')
$$

ä¸¤è€…å…³ç³»ï¼š
$$
V^{\mu}(s)=\sum_{o}\mu(o\mid s)Q^{\mu}(s,o)
$$

è‹¥ä½¿ç”¨æ˜¾å¼ $k$ å½¢å¼ï¼Œåˆ™ä¸ºï¼š
$$
V^{\mu}(s)=\sum_{o}\mu(o\mid s)\Big[R_{s}^{o}+\sum_{s'}\sum_{k\ge1}\gamma^{k}P(s',k\mid s,o)V^{\mu}(s')\Big]
$$
$$
Q^{\mu}(s,o)=R_{s}^{o}+\sum_{s'}\sum_{k\ge1}\gamma^{k}P(s',k\mid s,o)\sum_{o'}\mu(o'\mid s')Q^{\mu}(s',o')
$$

---

### (2) Bellman æœ€ä¼˜æ–¹ç¨‹ï¼ˆOptimalityï¼‰

çŠ¶æ€ä»·å€¼å‡½æ•°ï¼š
$$
V^{*}(s)=\max_{o}\Big[r_{s}^{o}+\sum_{s'}p_{ss'}^{o}V^{*}(s')\Big]
$$

é€‰é¡¹ä»·å€¼å‡½æ•°ï¼š
$$
Q^{*}(s,o)=r_{s}^{o}+\sum_{s'}p_{ss'}^{o}\max_{o'}Q^{*}(s',o')
$$

åŒæ ·ï¼š
$$
V^{*}(s)=\max_{o}Q^{*}(s,o)
$$

è‹¥å†™æ˜¾å¼ $k$ï¼š
$$
V^{*}(s)=\max_{o}\Big[R_{s}^{o}+\sum_{s'}\sum_{k\ge1}\gamma^{k}P(s',k\mid s,o)V^{*}(s')\Big]
$$
$$
Q^{*}(s,o)=R_{s}^{o}+\sum_{s'}\sum_{k\ge1}\gamma^{k}P(s',k\mid s,o)\max_{o'}Q^{*}(s',o')
$$

---

### âœ… æ€»ç»“å¯¹æ¯”è¡¨

| é¡¹ç›®   | æ™®é€š MDP                                               | SMDPï¼ˆOptionsï¼‰                                           |
| ---- | ---------------------------------------------------- | ------------------------------------------------------- |
| å†³ç­–å•ä½ | åŸå­åŠ¨ä½œ $a$                                             | é€‰é¡¹ $o$ï¼ˆå¤šæ­¥åŠ¨ä½œï¼‰                                            |
| æ—¶é•¿   | å›ºå®šä¸º1æ­¥                                                | éšæœº $k\ge1$                                              |
| å¥–åŠ±é¡¹  | $r(s,a)$                                             | $r_s^{o}=\mathbb{E}[\sum_{i=0}^{k-1}\gamma^{i}r_{t+i}]$ |
| æŠ˜æ‰£é¡¹  | $\gamma$                                             | $\gamma^{k}$ æˆ–å¸æ”¶äº $p_{ss'}^{o}$                         |
| çŠ¶æ€æ–¹ç¨‹ | $V^{\pi}(s)=\sum_{a}\pi(a\mid s)[r+\gamma PV^{\pi}]$ | $V^{\mu}(s)=\sum_{o}\mu(o\mid s)[r^{o}+p^{o}V^{\mu}]$   |
| æœ€ä¼˜æ–¹ç¨‹ | $\max_{a}[r+\gamma PV^{*}]$                          | $\max_{o}[r^{o}+p^{o}V^{*}]$                            |
| å…³ç³»   | $V=\Pi Q$                                            | $V=\Mu Q$                                               |

---

æ˜¯å¦å¸Œæœ›æˆ‘å†å¸®ä½ æŠŠè¿™ç»„ MDP vs SMDP çš„æ–¹ç¨‹å¯¹ç…§åˆ¶æˆè¡¨æ ¼å¼ LaTeX æºç ï¼ˆé€‚åˆç›´æ¥æ”¾è¿›è®ºæ–‡æˆ–ç¬”è®°ï¼‰ï¼Ÿ
