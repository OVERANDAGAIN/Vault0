好的，这里我们**严格对照论文原文**，把 **PO-Overcooked 的环境目标** 和 **episode 的定义/终止条件** 一次性说清楚，避免任何“读法歧义”。

---

## 一、PO-Overcooked 的环境目标（论文明确表述）

### 1️⃣ 总体目标（跨 episode）

论文在 **Problem Formulation（Sec. 3.1）** 中明确给出 peer adaptation 的目标函数：

$$\max ;\mathbb{E}\Big[\sum_{n=1}^{N_{\text{eps}}}\sum_{t=1}^{T_n} r^1_{n,t}\Big]$$

即：

* **目标不是单个 episode 成功**
* 而是 **在固定 peer 的情况下，跨 (N_{\text{eps}}) 个 episode 的累计回报最大化**
* 这一定义对 **PO-Overcooked 同样成立** 

---

### 2️⃣ 在 PO-Overcooked 中，任务目标具体是什么？

在 **Sec. 4.1 + PO-Overcooked 描述段落**，论文写得非常直接：

> *“The ego agent should explore the peer’s preferences and determine its preferred recipe **before making the target dish**.”* 

也就是说：

* **目标不是**：

  > 在 9 个 recipe 中任选一个完成即可
* **而是**：

  > 识别当前 peer 的 recipe preference，并完成该 recipe

这是一个**识别 → 匹配 → 合作完成**的过程。

---

## 二、PO-Overcooked 中的 “成功” 是怎么定义的？

### 1️⃣ reward 结构（附录 A.2）

PO-Overcooked 是**完全合作**环境，reward 由三部分组成：

1. **交互 reward**：

   * 与新物体交互：+0.5
2. **进度 reward**：

   * recipe 状态推进（如 chopped → plated）：+1.0
3. **完成 reward（关键）**：

   * **当一个“满足 recipe 的 dish”被送到 delivery square**：
     [
     +10.0
     ]

📌 **关键点**：

* reward 是 recipe-conditioned 的
* peer **只会推进其偏好 recipe** 的子任务
* ego 若做错 recipe：

  * peer 不配合
  * 很难拿到 +10 的完成 reward



---

## 三、一个 episode 在 PO-Overcooked 中是如何定义的？

### 1️⃣ episode 是什么？

在 **Sec. 3.1 + Sec. 4.3** 中可以确认：

* PO-Overcooked 是 **finite-horizon episode**
* 每个 episode：

  * **持续固定步数（dozens of steps）**
  * **不以“成功做完一道菜”为终止条件**

> *“The context consists of a small number of episodes (Neps = 5), each lasting for dozens of steps.”* 

---

### 2️⃣ episode 什么时候结束？

* **达到最大时间步 T**
* 而不是：

  * 完成某道菜就立刻结束

这点与一些 Overcooked 变体（success-terminated）**不同**，但在本论文中是**明确的**。

---

## 四、evaluation 时，什么算“成功”？

在 **Fig. 4(b)** 和 **Table 3** 中，PO-Overcooked 的评价指标是：

* **Success Rate over (N_{\text{eps}})**

结合上下文与实现逻辑，可以明确：

> **Success = 在 episode 内成功完成 peer 偏好的 recipe（至少一次）**

因为：

* 只有这样才能稳定拿到 +10 完成 reward
* baselines 的 success rate ≈ 0.1
  → 说明它们**没有正确匹配 peer recipe**



---

## 五、综合结论（可以直接写进你们的文档）

你可以非常严谨地这样总结：

> **在 Fast Peer Adaptation with Context-aware Exploration 中，PO-Overcooked 的任务目标是：在一个固定但未知 recipe preference 的合作伙伴存在下，通过跨 episode 的交互识别该偏好，并与其协作完成对应 recipe，以最大化跨 (N_{\text{eps}}) 个 episode 的累计回报。每个 episode 为固定时长，不以完成菜谱作为终止条件。**

---

## 六、一句“防误解”的对照总结

* ❌ **不是**：
  “从 9 个 recipe 里任选一个完成就算成功”
* ✅ **而是**：
  “你必须完成 **对手想做的那个 recipe**，否则基本没有回报”

如果你愿意，下一步我可以帮你把 **PO-Overcooked 的 episode / reward / peer preference** 抽象成一个 **formal task tuple**，直接对照你们现有的 adaptation benchmark。
