[[Alice in Differentiable Wonderland]]

# 问题：为什么$Y_{j}$ 那里需要转置？
p17


**Definition D.2.3 (Matrix multiplication)** Given two matrices **X** ∼ (a, b) and **Y** ∼ (b, c), matrix multiplication **Z = XY**, with **Z ∼ (a, c)** is defined element-wise as:

$$
Z_{ij} = \langle X_i, Y_j^{\top} \rangle \tag{E.2.4}
$$

i.e., the element (i, j) of the product is the dot product between the i-th row of **X** and the j-th column of **Y**.

好问题 👍，这个涉及到矩阵乘法的本质。我们一步一步来看：

---

### 1. 矩阵乘法的定义

给定

$$
X \in \mathbb{R}^{a \times b}, \quad Y \in \mathbb{R}^{b \times c},
$$

它们的乘积是

$$
Z = XY \in \mathbb{R}^{a \times c}.
$$

其中，$Z$ 的元素由以下公式给出：

$$
Z_{ij} = \sum_{k=1}^b X_{ik} Y_{kj}.
$$

---

### 2. 为什么要转置？

* $X_i$：表示 **X 的第 i 行**，形状是 **(1, b)**，是一个行向量。
* $Y_j$：表示 **Y 的第 j 列**，形状是 **(b, 1)**，是一个列向量。

要计算它们的 **点积 (dot product)**：

$$
Z_{ij} = X_i \cdot Y_j
$$

必须保证两边形状一致：

* $X_i$ 是行向量 $(1 \times b)$。
* $Y_j$ 是列向量 $(b \times 1)$。

所以写成内积的时候，常用形式是：

$$
Z_{ij} = \langle X_i, Y_j^{\top} \rangle
$$

这里的 **转置 $Y_j^{\top}$** 是为了把 $Y_j$ 从列向量变成行向量，与 $X_i$ 的行向量形状匹配，方便写成“内积”的形式。

---

### 3. 更直观的理解

* 你可以把 **矩阵乘法**理解为：
  **每一行**的向量 $X_i$，去和 **每一列**的向量 $Y_j$ 做点积。
* 转置只是为了记号整齐，因为在标准内积记法 $\langle u, v \rangle$ 中，两个向量默认都是行向量。

换句话说，数学写法强调“点积”，而程序里你直接写 `X[i] @ Y[:, j]` 就不会显式写转置。
