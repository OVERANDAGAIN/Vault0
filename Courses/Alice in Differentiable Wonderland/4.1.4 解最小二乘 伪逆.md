

[[Alice in Differentiable Wonderland]]





好的，我把“最小二乘解”的关键结论重新整理并用标准公式排版：

## 最小二乘（Least Squares）

给定 $X\in\mathbb{R}^{n\times d}$, $y\in\mathbb{R}^n$，求

$$
\min_{w\in\mathbb{R}^d}\;\|Xw-y\|_2^2.
$$

### 1) 正规方程（Normal equations）

$$
X^{\top}(Xw-y)=0 \;\;\Longleftrightarrow\;\; X^{\top}X\,w = X^{\top}y.
$$

### 2) 闭式解（Closed-form）

若 $X^{\top}X$ 可逆，

$$
w_* = (X^{\top}X)^{-1}X^{\top}y.
$$

### 3) 伪逆形式（Pseudoinverse）

把 Moore–Penrose 伪逆写作

$$
X^{+} = (X^{\top}X)^{-1}X^{\top}\quad(\text{当 }X^{\top}X\text{ 可逆时}),
$$

则

$$
w_* = X^{+}y.
$$

### 4) 投影解释（Projection）

预测为

$$
\hat y = Xw_* = X(X^{\top}X)^{-1}X^{\top}y \;=\; P_X\,y,
$$

其中

$$
P_X := X(X^{\top}X)^{-1}X^{\top}
$$

是把 $y$ 正交投影到 $X$ 的列空间的投影矩阵。

> 数值实现上，优先用 `solve`/QR/SVD 等求解 $X^{\top}X\,w=X^{\top}y$，比显式求逆更稳定。
