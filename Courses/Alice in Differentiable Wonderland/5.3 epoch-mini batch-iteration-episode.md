[[Alice in Differentiable Wonderland]]

好问题 👌，这些词在 **深度学习** 和 **强化学习** 里有时语境不同，容易混淆。下面我帮你梳理清楚，并结合你 HOP+ 的多智能体并行环境来解释：

---

# 📑 Epoch / Iteration / Episode / Game / Parallel Envs 的区别与联系

## 1. **Epoch（训练轮次）**

* **定义**：完整地用一遍训练数据集。
* 在监督学习里：

  * 假如数据集有 1000 个样本，batch size = 20。
  * 一个 **epoch = 1000/20 = 50 iterations**。
* 在 RL（强化学习）里：

  * 一个 epoch 通常指 **收集一定数量的交互数据 + 用这些数据更新策略一次**。
  * 例如：PPO 里可能定义 `epoch = 2048 步经验 + K 次更新`。

---

## 2. **Iteration（迭代）**

* **定义**：一次 **参数更新**。
* 在监督学习：

  * 一次 iteration = 取一个 mini-batch → 前向传播 → 反向传播 → 更新参数。
* 在 RL：

  * 一次 iteration 常指一次 **采样+更新循环**，但有时更细化为“1 次梯度更新步骤”。
  * 不同论文代码可能有区别，要看上下文。

---

## 3. **Episode（完整轨迹 / 一局游戏）**

* **定义**：在环境里从初始状态到终止状态的一条完整轨迹。
* 举例：

  * 在 CartPole 中：一条 episode = 杆从开始 → 杆倒下。
  * 在 HOP+ StagHunt：一条 episode = 猎人和兔子从地图初始 → 时间步上限 / 提前终止。

👉 **Episode 的长度**：可能固定（比如 max steps=100）或变长（直到 done=True）。

---

## 4. **Game（一场博弈 / 一次环境运行）**

* 在 RL 文献中，**game ≈ episode**，就是一次环境从开始到结束。
* 在多智能体环境中，一个 game 可以包含多个 agent 的交互。
* 例如 HOP+：一次 game 中，4 个 agent 同时在格子世界里行动 → game 结束时得到一条完整 joint trajectory。

---

## 5. **Parallel Environments（并行环境）**

* **定义**：同时运行多个环境实例，提升采样效率。
* 举例：

  * 假设每个 episode 平均 100 步，单环境采样太慢。
  * 用 8 个并行环境，每次 step 可以同时收集 8 条数据 → 训练更高效。
* 在 HOP+：

  * 你可能跑 `num_envs=16`，意味着 16 个 StagHuntEnv 并行生成轨迹。
  * 一次迭代里，你可能收集 `16 envs × 128 steps = 2048 transitions`，再统一拿去更新策略。

---

# 🔗 总结联系（按时间/逻辑顺序）

1. **Episode / Game**：一次环境运行，从头到尾。
2. **Step**：episode 中的一个时间步（agent 执行动作，环境返回状态和奖励）。
3. **Parallel envs**：同时跑很多 episode/step，加快采样。
4. **Iteration**：取一批数据（可能来自很多 episode、很多 envs），做一次参数更新。
5. **Epoch**：数据集（或采样预算）被完整用一次，包含多个 iteration。

---

# 📌 举个 HOP+ 多环境 PPO 的例子

* 配置：`num_envs=8`，每个 env 最长 `100 steps`，每次 rollout 收集 `128 steps/env`。
* **一次 rollout** = 8×128 = 1024 transitions。
* **Iteration**：用这 1024 条数据更新网络一次（可能 mini-batch 拆分多次梯度更新）。
* **Epoch**：可能定义为“用完整的 rollout 数据跑完所有 mini-batch 更新”。
* **Episode/Game**：在某个 env 里从 t=0 到 done（可能 <100 步）。

---

👉 直观比喻：

* **Episode/Game** = 打完一局王者荣耀。
* **Step** = 在这一局里点了一次技能。
* **Parallel envs** = 你开了 8 台手机同时打。
* **Iteration** = 你用刚刚这几局的经验学习一次。
* **Epoch** = 你规定“看完所有经验再学一轮”。

---

要不要我帮你画一个 **时间线图/流程图**（带并行 envs, episode, iteration, epoch 的层级关系）？这样放到笔记里会更直观。
