---
创建时间: 2025-十月-7日  星期二, 10:16:45 晚上
---
[[Alice in Differentiable Wonderland]]
p89

![[Pasted image 20251007221729.png]]

![[Pasted image 20251007221748.png]]


这个地方的 **“rank”** 和 **线性代数里矩阵的秩**不是一个意思，它指的是 **张量的阶 (tensor rank, 也叫 order)**，也就是“有多少个维度（轴，axes）”。

---

## 🔹 推导过程

1. **输入和输出形状**

   * 输入：$X \in \mathbb{R}^{n \times c}$
     （$n$ 个样本，每个样本 $c$ 个特征）
   * 权重：$W \in \mathbb{R}^{c \times c'}$
   * 输出：$Y \in \mathbb{R}^{n \times c'}$

2. **输入的 Jacobian**

   * ==Jacobian 本质上==是 $\frac{\partial \text{(输出)}}{\partial \text{(输入)}}$。
   * 输出 $Y$ 有 $(n \times c')$ 个分量，输入 $X$ 有 $(n \times c)$ 个分量。
   * 所以严格的 Jacobian 是一个大矩阵：
     $$
     J_X \in \mathbb{R}^{(n \cdot c') \times (n \cdot c)}.
     $$
   * 但书里为了保持“张量形状”的直观性，把它 reshape 成：
     $$
     (n, c', n, c)
     $$
     → 表示对每个 $(n, c')$ 输出分量，对应一个 $(n, c)$ 输入分量。
   * 这个张量有 **4 个维度**，所以说 **rank = 4**。

3. **权重的 Jacobian**

   * 对权重 $W \in \mathbb{R}^{c \times c'}$ 求导：
     输出 $Y \in \mathbb{R}^{n \times c'}$。
   * 所以形状是：
     $$
     (n, c', c, c')
     $$
     → 表示每个输出 $(n, c')$ 对应权重 $(c, c')$ 的梯度。
   * 同样这是 4 个维度 → **rank = 4**。

---

## 🔹 直观理解

* **矩阵秩 (rank)**：线性无关的行/列数。
* **张量 rank/order**：多少维的数组。
* 这里的 **rank=4** 是指 Jacobian 被 reshape 成了四维张量。

---

## 🔹 举个小例子

假设：

* $n=2, c=3, c'=2$
* 输入 $X \in \mathbb{R}^{2 \times 3}$
* 输出 $Y \in \mathbb{R}^{2 \times 2}$

那么：

* 输入 Jacobian：形状 $(2,2,2,3)$，即 $[n, c', n, c]$
* 权重 Jacobian：形状 $(2,2,3,2)$，即 $[n, c', c, c']$
* 这两个都是四维数组 → rank=4。

---

